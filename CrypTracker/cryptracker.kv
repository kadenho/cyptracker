#:import text_color_from_value main.text_color_from_value

ScreenManager:
    #Main app screens
    UserLoginScreen:
    CreateProfileScreen:
    MainDashboardScreen:
    AboutHelpScreen:
    MySQLPasswordScreen:
    PriceTrendsScreen:

#Main app GUI
<MySQLPasswordScreen>
    name: 'MySQLPasswordScreen'
    canvas.before:
        Color:
            rgba: (0,0,0,1)
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        Widget:
        Text:
            text: 'Enter your password to MySQL'
            font_size: sp(50)
            color: (1,1,1,1)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            TextInput:
                id: password_text_input
                font_size: sp(30)
            Widget:
                size_hint: (.25, 1)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: enter_password_button
                text: 'Enter'
                font_size: sp(30)
                on_press:
                    app.on_enter_password_button_press()
            Widget:
                size_hint: (.25, 1)
        Widget:
<UserLoginScreen>:
    name: 'UserLoginScreen'
    canvas.before:
        Color:
            rgba: (0,0,0,1)
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'CrypTracker'
            font_size: sp(50)
            color: (1,1,1,1)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Spinner:
                id: username_selector_spinner
                text: 'Select An Account'
                font_size: sp(30)
                values:
            Widget:
                size_hint: (.25, 1)
        Label:
            id: username_selector_message_label
            text: ''
            font_size: sp(30)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: login_button
                text: 'Login'
                font_size: sp(30)
                on_press:
                    app.on_login_button_press()
                    app.display_home_screen_graph()
            Widget:
                size_hint: (.25, 1)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: create_username_page_button
                text: 'Create New Username'
                font_size: sp(30)
                on_press: app.on_create_username_page_button_press()
            Widget:
                size_hint: (.25, 1)
        Widget:
<CreateProfileScreen>:
    name: 'CreateProfileScreen'
    canvas.before:
        Color:
            rgba: (0,0,0,1)
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'Create Profile'
            font_size: sp(50)
            color: (1,1,1,1)
        Widget:
        Widget:
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Label:
                text: 'Enter New Username'
                font_size: sp(30)
            Widget:
                size_hint: (.25, 1)
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            TextInput:
                id: new_username_text_input
                font_size: sp(30)
            Widget:
                size_hint: (.25, 1)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: create_username_button
                text: 'Create New Username'
                font_size: sp(30)
                on_press: app.on_create_username_button_press()
            Widget:
                size_hint: (.25, 1)
        Label:
            id: username_message_label
            text: ''
            font_size: sp(20)
        Widget:
<MainDashboardScreen>
    name: 'MainDashboardScreen'
    canvas.before:
        Color:
            rgba: (0,0,0,1)
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'CrypTracker'
            font_size: sp(50)
            color: (1,1,1,1)
        Label:
            id: menu_username
            text: 'Welcome, username'
            font_size: sp(50)
            color: (1,1,1,1)
        BoxLayout:
            size_hint: (1, 5)
            orientation: 'vertical'
            id: dashboard_chart_box
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: portfolio_button
                text: 'Portfolio'
                font_size: sp(30)
                on_press: app.on_portfolio_button_press()
            Widget:
                size_hint: (.25, 1)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: historical_price_button
                text: 'Price History'
                font_size: sp(30)
                on_press:
                    app.populate_list()
                    app.on_historical_price_button_press()
            Widget:
                size_hint: (.25, 1)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: price_trends_button
                text: 'Price Trends'
                font_size: sp(30)
                on_press: app.on_price_trends_button_press()
            Widget:
                size_hint: (.25, 1)
        Widget:
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: switch_user_button
                text: 'Switch User'
                font_size: sp(30)
                on_press: app.on_switch_user_button_press()
            Widget:
                size_hint: (.25, 1)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: about_help_button
                text: 'About/Help'
                font_size: sp(30)
                on_press: app.on_about_help_button_press()
            Widget:
                size_hint: (.25, 1)
        Widget:
<AboutHelpScreen>:
    name: 'AboutHelpScreen'

    canvas.before:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size

    ScrollView:
        id: instructions_scroll
        do_scroll_x: False

        BoxLayout:
            orientation: 'vertical'
            size_hint_y: None
            padding: 20
            spacing: 20
            height: self.minimum_height

            Label:
                text: 'About / Help'
                font_size: sp(50)
                color: 1, 1, 1, 1
                size_hint_y: None
                height: self.texture_size[1]

            Label:
                text: 'Portfolio App Instructions'
                font_size: sp(30)
                halign: 'center'
                valign: 'middle'
                color: 1, 1, 1, 1
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]

            Label:
                text: 'Manage Cryptocurrencies'
                font_size: sp(25)
                halign: 'center'
                valign: 'middle'
                color: 1, 1, 1, 1
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]

            Label:
                text: "Add a coin by submitting the coin's name and symbol.\nDelete a coin by submitting the coin's ID, name, and symbol."
                font_size: sp(20)
                color: 1, 1, 1, 1
                halign: 'left'
                valign: 'top'
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]

            Label:
                text: 'Manage Portfolio Entries'
                font_size: sp(25)
                halign: 'center'
                valign: 'middle'
                color: 1, 1, 1, 1
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]
            Label:
                text: "Add a portfolio entry by submitting the ID of the crypto bought, the day it was bought (within the last year), and the amount purchased.\n\nUpdate a portfolio entry by selecting an entry and editing its information.\nDelete a portfolio entry by selecting an entry and deleting it."
                font_size: sp(20)
                color: 1, 1, 1, 1
                halign: 'left'
                valign: 'top'
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]

            Label:
                text: 'Check Portfolio Value'
                font_size: sp(25)
                color: 1, 1, 1, 1
                halign: 'center'
                valign: 'middle'
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]

            Label:
                text: "View your complete portfolio value and last updated date.\n\nA pie chart of coins invested can be viewed under the 'View Pie Chart' button.\n\nThe 'Fetch New Prices' button updates current values to reflect your true portfolio value."
                font_size: sp(20)
                color: 1, 1, 1, 1
                halign: 'left'
                valign: 'top'
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]
            Label:
                text: 'Historical Price App Instructions'
                font_size: sp(30)
                halign: 'center'
                valign: 'middle'
                color: 1, 1, 1, 1
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]
            Label:
                text: "Coins are list on the left along with their respective value and percent change to the right. You are able to find more coins via the next and back button or by searching in the search bar. "
                font_size: sp(20)
                color: 1, 1, 1, 1
                halign: 'left'
                valign: 'top'
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]
            Label:
                text: "After selecting a coin you are given the options of displaying the coins price in a variety of graph types as well as time intervals."
                font_size: sp(20)
                color: 1, 1, 1, 1
                halign: 'left'
                valign: 'top'
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]
            Label:
                text: "You are also given the option to export the coins price data to a CSV file which is added to the directory."
                font_size: sp(20)
                color: 1, 1, 1, 1
                halign: 'left'
                valign: 'top'
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]
            Label:
                text: "Link to CoinGecko API documentation:\nhttps://docs.coingecko.com/v3.0.1/reference/endpoint-overview"
                font_size: sp(18)
                color: 1, 1, 1, 1
                halign: 'left'
                valign: 'middle'
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]

            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: 60
                spacing: 10

                Widget:
                    size_hint_x: 0.25

                Button:
                    id: about_help_back_button
                    text: 'Back'
                    font_size: sp(30)
                    size_hint_x: 0.5
                    on_press:
                        app.on_about_help_back_button_press()
                        app.display_home_screen_graph()

                Widget:
                    size_hint_x: 0.25
<PriceTrendsScreen>
    name: 'PriceTrendsScreen'
    canvas.before:
        Color:
            rgba: (0,0,0,1)
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'Price Trends'
            font_size: sp(50)
            color: (1,1,1,1)
        Widget:
        BoxLayout:
            orientation: 'horizontal'
            Widget:
                size_hint: (.25, 1)
            Button:
                id: price_trends_back_button
                text: 'Back'
                font_size: sp(30)
                on_press:
                    app.on_price_trends_back_button_press()
                    app.display_home_screen_graph()
            Widget:
                size_hint: (.25, 1)
        Widget:
<PortfolioMenuScreen>
    Label:
        text: app.title_text
        color: (0, 0, 0, 1)
        pos_hint: {'center': (0.5, 0.8)}
        font_size: 36
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1.0,0.8)
        pos_hint: {'center': (0.5,0.4)}
        padding: (0, 100, 0, 50)
        spacing: 50

        CustomButton:
            text: 'Manage Cryptocurrencies'
            text_color: (0.8, 0.8, 0.8, 1)
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                root.manager.current = 'Manage Cryptocurrencies'


        CustomButton:
            text: 'Manage Portfolio Entries'
            text_color: (0.8, 0.8, 0.8, 1)
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                root.manager.current = 'Manage Portfolio Entries'

        CustomButton:
            text: 'Check Portfolio Value'
            text_color: (0.8, 0.8, 0.8, 1)
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                root.manager.current = 'Check Portfolio'

        CustomButton:
            text: 'Return to CrypTracker'
            text_color: (0.8, 0.8, 0.8, 1)
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                app.display_home_screen_graph()
                root.manager.current = 'MainDashboardScreen'

<ManageCryptoCurrenciesScreen>
    Label:
        text: 'Manage Cryptocurrencies'
        pos_hint: {'center': (0.5, 0.9)}
        size_hint: (1.0,0.1)
        font_size: 24
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.8)
        pos_hint: {'center': (0.5,0.4)}
        padding: (0, 0, 0, 50)
        spacing: 50

        CustomButton:
            text: 'Add Cryptocurrency'
            size_hint_x: 0.5
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                root.manager.current = 'Add Cryptocurrency'

        CustomButton:
            text: 'Delete Cryptocurrency'
            size_hint_x: 0.5
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                root.manager.current = 'Delete Cryptocurrency'

        CustomButton:
            text: 'Return to Menu'
            pos_hint: {'x': 0.125}
            size_hint_x: 0.75
            on_press:
                root.manager.current = 'Portfolio Menu'

<AddCryptoCurrencyScreen>
    Label:
        text: 'New Cryptocurrency'
        pos_hint: {'center': (0.5, 0.9)}
        font_size: 24
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.8)
        pos_hint: {'center': (0.5,0.4)}
        padding: (0, 0, 0, 50)
        spacing: 20

        Label:
            text: 'Please add a new cryptocurrency to the database.'
            pos_hint: {'center': (0.5, 0.5)}
            text_size: self.size
            halign: 'center'
            valign: 'middle'
        Label:
            text: 'Name'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        TextInput:
            id: crypto_name
            hint_text: 'Bitcoin'
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        Label:
            text: 'Symbol'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        TextInput:
            id: crypto_symbol
            hint_text: 'btc'
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        CustomButton:
            text: 'Add Cryptocurrency'
            size_hint_x: 0.5
            pos_hint: {'x': 0.25}
            on_press:
                app.add_crypto(name=root.ids.crypto_name.text, symbol=root.ids.crypto_symbol.text)

        CustomButton:
            text: 'Return to Cryptocurrencies'
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            size_hint_x: 0.75
            on_press:
                root.manager.current = 'Manage Cryptocurrencies'

<DeleteCryptoCurrencyScreen>
    Label:
        text: 'Delete Cryptocurrency'
        pos_hint: {'center': (0.5, 0.9)}
        size_hint: (1.0,0.1)
        font_size: 24
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.8)
        pos_hint: {'center': (0.5,0.45)}
        padding: (0, 0, 0, 0)
        spacing: 10

        Label:
            text: 'Please select a cryptocurrency entry to delete.'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        Spinner:
            id: spinner_delete_crypto
            text: 'Crypto ID'
            values: []
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                self.values = app.crypto_ids
            on_text:
                # Call update_page method of the DeleteCryptocurrencyScreen class
                self.parent.parent.update_page()

        Label:
            text: 'Crypto Name'
            color: [0.0, 0.0, 0.0, 1.0]
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        Label:
            id: delete_crypto_name
            text: ''
            color: [1.0, 1.0, 1.0, 1.0]
            outline_color: [0.0, 0.0, 0.0, 1.0]
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        Label:
            text: 'Crypto Symbol'
            color: [0.0, 0.0, 0.0, 1.0]
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        Label:
            id: delete_crypto_symbol
            text: ''
            color: [1.0, 1.0, 1.0, 1.0]
            outline_color: [0.0, 0.0, 0.0, 1.0]
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        CustomButton:
            text: 'Delete Cryptocurrency'
            size_hint_x: 0.5
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                app.delete_crypto(root.ids.spinner_delete_crypto.text)

        CustomButton:
            text: 'Return to Cryptocurrencies'
            pos_hint: {'x': 0.125}
            size_hint_x: 0.75
            on_press:
                root.manager.current = 'Manage Cryptocurrencies'

<ManagePortfolioEntriesScreen>
    Label:
        text: 'Manage Portfolio Entries'
        pos_hint: {'center': (0.5, 0.9)}
        size_hint: (1.0,0.1)
        font_size: 24
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.8)
        pos_hint: {'center': (0.5,0.4)}
        padding: (0, 0, 0, 50)
        spacing: 50

        CustomButton:
            text: 'Add Portfolio Entry'
            size_hint_x: 0.5
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                root.manager.current = 'Add Portfolio Entry'

        CustomButton:
            text: 'Update Portfolio Entry'
            size_hint_x: 0.5
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                root.manager.current = 'Update Portfolio Entry'

        CustomButton:
            text: 'Delete Portfolio Entry'
            size_hint_x: 0.5
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                root.manager.current = 'Delete Portfolio Entry'

        CustomButton:
            text: 'Return to Menu'
            pos_hint: {'x': 0.125}
            size_hint_x: 0.75
            on_press:
                root.manager.current = 'Portfolio Menu'

<AddPortfolioEntryScreen>
    Label:
        text: 'Add Portfolio Entry'
        pos_hint: {'center': (0.5, 0.9)}
        size_hint: (1.0,0.1)
        font_size: 24
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.8)
        pos_hint: {'center': (0.5,0.4)}
        padding: (0, 0, 0, 0)
        spacing: 20

        Label:
            text: 'Please add a new portfolio entry to the database.'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        Spinner:
            id: spinner_crypto_id
            text: 'Crypto ID'
            values: app.crypto_ids
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                self.values = app.crypto_ids

        Label:
            text: 'Date Purchased'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        TextInput:
            id: date_text
            hint_text: 'YYYY-MM-DD'
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        Label:
            text: 'Quantity Purchased'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        TextInput:
            id: quantity_text
            input_filter: 'int'
            hint_text: '1'
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        CustomButton:
            text: 'Add Portfolio Entry'
            size_hint_x: 0.5
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                app.modify_portfolio_entry(root.ids.spinner_crypto_id.text, root.ids.date_text.text, root.ids.quantity_text.text, 'Add')
                quantity_text = ''
                date_text = ''

        CustomButton:
            text: 'Return to Portfolio Entries'
            pos_hint: {'x': 0.125}
            size_hint_x: 0.75
            on_press:
                root.manager.current = 'Manage Portfolio Entries'

<UpdatePortfolioEntryScreen>
    Label:
        text: 'Update Portfolio Entry'
        pos_hint: {'center': (0.5, 0.9)}
        size_hint: (1.0,0.1)
        font_size: 24
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.8)
        pos_hint: {'center': (0.5,0.45)}
        padding: (0, 0, 0, 0)
        spacing: 10

        Label:
            text: 'Please select a portfolio entry to update.'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        Spinner:
            id: spinner_update_portfolio
            text: 'Entry ID'
            values: []
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                self.values = app.portfolio_info
            on_text:
            # Calls the update_page() method from UpdatePortfolioEntryScreen
                self.parent.parent.update_page()

        Spinner:
            id: update_spinner_crypto_id
            text: 'Crypto ID'
            values: app.crypto_ids
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                self.values = app.crypto_ids

        Label:
            text: 'Date Purchased'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        TextInput:
            id: update_date_text
            hint_text: 'YYYY-MM-DD'
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        Label:
            text: 'Quantity Purchased'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        TextInput:
            id: update_quantity_text
            input_filter: 'int'
            hint_text: '1'
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        CustomButton:
            text: 'Update Portfolio Entry'
            size_hint_x: 0.5
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                app.modify_portfolio_entry(root.ids.update_spinner_crypto_id.text,
                root.ids.update_date_text.text,
                root.ids.update_quantity_text.text,
                entry_id=root.ids.spinner_update_portfolio.text,
                operation='Update'
                )
                quantity_text = ''
                date_text = ''

        CustomButton:
            text: 'Return to Portfolio Entries'
            pos_hint: {'x': 0.125}
            size_hint_x: 0.75
            on_press:
                root.manager.current = 'Manage Portfolio Entries'

<DeletePortfolioEntryScreen>
    Label:
        text: 'Delete Portfolio Entry'
        pos_hint: {'center': (0.5, 0.9)}
        size_hint: (1.0,0.1)
        font_size: 24
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.8)
        pos_hint: {'center': (0.5,0.45)}
        padding: (0, 0, 0, 0)
        spacing: 10

        Label:
            text: 'Please select a portfolio entry to delete.'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        Spinner:
            id: spinner_delete_portfolio
            text: 'Entry ID'
            values: []
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                self.values = app.portfolio_info
            on_text:
                self.parent.parent.update_page()

        Label:
            id: delete_crypto_id
            text: 'Crypto ID'
            color: [1.0, 1.0, 1.0, 1.0]
            outline_color: [0.0, 0.0, 0.0, 1.0]
            size_hint: (0.5,1.0)
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        Label:
            text: 'Date Purchased'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        Label:
            id: delete_date_text
            text: 'YYYY-MM-DD'
            color: [1.0, 1.0, 1.0, 1.0]
            outline_color: [0.0, 0.0, 0.0, 1.0]
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        Label:
            text: 'Quantity Purchased'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        Label:
            id: delete_quantity_text
            text: '0'
            color: [1.0, 1.0, 1.0, 1.0]
            outline_color: [0.0, 0.0, 0.0, 1.0]
            size_hint_x: 0.8
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}

        CustomButton:
            text: 'Delete Portfolio Entry'
            size_hint_x: 0.5
            pos_hint: {'x': 0.5 - self.size[0]/(2*self.parent.size[0])}
            on_press:
                app.modify_portfolio_entry(
                entry_id=root.ids.spinner_delete_portfolio.text,
                operation='Delete'
                )

        CustomButton:
            text: 'Return to Portfolio Entries'
            pos_hint: {'x': 0.125}
            size_hint_x: 0.75
            on_press:
                root.manager.current = 'Manage Portfolio Entries'

<CheckPortfolioScreen>
    Label:
        text: 'Portfolio Summary'
        pos_hint: {'center': (0.5, 0.9)}
        font_size: 24
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.8)
        pos_hint: {'center': (0.5,0.4)}
        padding: (0, 0, 0, 50)
        spacing: 20
        Label:
            text: 'Date of Report'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        Label:
            id: report_date
            text: f'{app.portfolio_report_date}'
            bold: True
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        Label:
            id: total_value
            text: f'Total Value: ${app.portfolio_report_total/100:,.2f}'
            text_size: self.size
            bold: True
            color: [0.0, 0.0, 0.0, 1.0]
            outline_width: 1
            halign: 'center'
            valign: 'middle'
            on_text:
                self.color = text_color_from_value(self.text, -100000, 100000)

        Label:
            text: 'Date of Last Report'
            text_size: self.size
            halign: 'center'
            valign: 'middle'

        Label:
            id: last_report_date
            text: f'{app.portfolio_report_previous_date}'
            text_size: self.size
            bold: True
            halign: 'center'
            valign: 'middle'

        Label:
            id: percent_change_from_last
            text: f'{app.portfolio_report_change_from_previous:,}% from Previous Report'
            color: [0.0, 0.0, 0.0, 1.0]
            text_size: self.size
            outline_width: 1
            bold: True
            halign: 'center'
            valign: 'middle'
            on_text:
                self.color = text_color_from_value(self.text, -100, 100)

        Label:
            id: percent_change_from_investment
            text: f'{app.portfolio_report_change_from_investment:,}% from Initial Investment'
            color: [0.0, 0.0, 0.0, 1.0]
            text_size: self.size
            outline_width: 1
            bold: True
            halign: 'center'
            valign: 'middle'
            on_text:
                self.color = text_color_from_value(self.text, -100, 100)

        CustomButton:
            text: 'View Pie Chart'
            pos_hint: {'x': 0.125}
            size_hint_x: 0.75
            on_press:
                root.manager.current = 'Pie Chart'

        CustomButton:
            text: 'Return to Menu'
            pos_hint: {'x': 0.125}
            size_hint_x: 0.75
            on_press:
                root.manager.current = 'Portfolio Menu'

        CustomButton:
            text: 'Fetch New Prices'
            pos_hint: {'x': 0.125}
            size_hint_x: 0.75
            on_press:
                app.add_value_check()

<PieChartScreen>
    Label:
        text: 'Summary Details'
        pos_hint: {'center': (0.5, 0.9)}
        font_size: 24
        text_size: self.size
        halign: 'center'
        valign: 'middle'

    BoxLayout:
        orientation: 'vertical'
        size_hint: (1,0.8)
        pos_hint: {'center': (0.5,0.4)}
        padding: (0, 0, 0, 50)
        spacing: 20

        BoxLayout:
            id: pie_chart_box
            orientation: 'vertical'
            size_hint: (1,1)
            padding: (0, 0, 0, 50)
            spacing: 20

        CustomButton:
            text: 'Return to Menu'
            pos_hint: {'x': 0.125}
            size_hint: (0.75, 0.125)
            on_press:
                root.manager.current = 'Portfolio Menu'


<Button>
    canvas.before:
        Color:
            rgb: self.background_color
        SmoothRoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [18]
    background_color: [1.0, 1.0, 1.0, 0.0]
    text_size: self.size
    halign: 'center'
    valign: 'middle'

<SpinnerOption>
    background_color: [1.0, 1.0, 1.0, 0.0]

<TextInput>
    write_tab: False
    multiline: False

<Screen>
    canvas.before:
        Color:
            rgba: [0.0, 0.0, 0.0, 1.0]
        Rectangle:
            pos: self.pos
            size: self.size
<AddDeleteScreen>
# Methods to reset the displayed data of screens that require inputting data
    on_enter:
        self.reset_page()
    on_leave:
        self.reset_page()

<Label>
    font_size: 24
    outline_width: 2
    outline_color: [1.0, 1.0, 1.0, 1.0]
    color: [0.0, 0.0, 0.0, 1.0]

#Historical price viewer

<Text>:
    color: (1.0, 1.0, 1.0)
    outline_width: 0
    size_hint: (1, 1)
    text_size: self.width, None
    halign: 'center'
    valign: 'middle'

<FormattedButton>
    background_color: (1, 1, 1, 0)
    color: (0.0, 0.0, 0.0)
    size_hint: (1, 1)
    text_size: self.width, None
    outline_width: 0
    height: self.texture_size[1]
    halign: 'center'
    valign: 'middle'

<BackButton>
    size_hint: (0.25,0.1)
    outline_width: 0

<SelectCryptoBox>
    orientation: 'horizontal'

    Button:
        text: '[' + root.crypto_symbol + '] ' + root.crypto_name
        outline_width: 0
        background_color: (1, 1, 1, 0)
        size_hint: (0.5, 1)
        text_size: self.width, None
        height: self.texture_size[1]
        halign: 'left'
        valign: 'middle'
        on_press:
            app.select_crypto(root.crypto_id)
            app.root.current = 'ViewHistoryScreen'

    Text:
        text: 'Value: $' + root.crypto_value
        font_size: sp(12)
        size_hint: (0.25, 1)

    Text:
        text: 'Change: ' + root.crypto_percent_change + '%'
        font_size: sp(12)
        size_hint: (0.25, 1)

<SelectCryptoScreen>

    BoxLayout:
        orientation: 'vertical'

        BackButton:
            id: select_crypto_screen_home_button
            text: 'Home'
            on_press:
                app.display_home_screen_graph()
                root.manager.current = 'MainDashboardScreen'
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                orientation: 'vertical'

                Text:
                    text: 'Historical Price Viewer'
                    font_size: sp(40)
                    font_name: 'Roboto-Bold'

                BoxLayout:
                    orientation: 'horizontal'

                    Widget:
                        orientation: 'vertical'
                        size_hint: (0.25, 1)

                    TextInput:
                        id: select_crypto_text_input
                        hint_text: 'Enter search'
                        multiline: False
                        size_hint: (0.5, 0.5)

                    Button:
                        id: select_crypto_enter_button
                        text: 'Search'
                        background_color: (1, 1, 1, 0)
                        text_size: self.width, None
                        outline_width: 0
                        height: self.texture_size[1]
                        halign: 'center'
                        valign: 'middle'
                        size_hint: (0.5,0.5)
                        on_press:
                            app.repopulate_list()

                    Widget:
                        orientation: 'vertical'
                        size_hint: (0.25, 1)

            BoxLayout:
                id: cryptos_list_boxlayout
                orientation: 'vertical'

            BoxLayout:
                orientation: 'horizontal'
                size_hint: (1, 0.1)

                FormattedButton:
                    id: select_crypto_list_back
                    text: 'Back'
                    on_press:
                        app.move_list_back()

                Widget:
                    size_hint: (1.5, 1)

                FormattedButton:
                    id: select_crypto_list_next
                    text: 'Next'
                    on_press:
                        app.move_list_forward()

<ViewHistoryScreen>:

    BoxLayout:
        orientation: 'vertical'

        BackButton:
            id: view_history_back_button
            text: 'Back'
            on_press:
                app.populate_list()
                root.manager.current = 'SelectCryptoScreen'

        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                orientation: 'vertical'
                BoxLayout:
                    orientation: 'horizontal'
                    FormattedButton:
                        text: '90 Day Graph'
                        on_press:
                            app.display_ninety_day_graph()
                    FormattedButton:
                        text: '30 Day Graph'
                        on_press:
                            app.display_thirty_day_graph()
                    FormattedButton:
                        text: '7 Day Graph'
                        on_press:
                            app.display_seven_day_graph()
                    FormattedButton:
                        text: '1 Day Graph'
                        on_press:
                            app.display_one_day_graph()
                BoxLayout:
                    orientation: 'horizontal'

                    FormattedButton:
                        text: 'Line Graph'
                        on_press:
                            app.display_line_graph()
                    FormattedButton:
                        text: 'Bar Graph'
                        on_press:
                            app.display_bar_graph()
                    FormattedButton:
                        text: 'Candlestick Graph'
                        on_press:
                            app.display_candlestick_graph()
                FormattedButton:
                    text: 'Export to CSV'
                    on_press:
                        app.export_to_csv()

            BoxLayout:
                size_hint: (1, 2)
                orientation: 'vertical'
                id: chart_box





